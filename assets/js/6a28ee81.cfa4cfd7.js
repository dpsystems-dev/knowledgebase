"use strict";(globalThis.webpackChunkabm_web_portal_docs=globalThis.webpackChunkabm_web_portal_docs||[]).push([[6033],{2801(e,t,n){n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>a,frontMatter:()=>i,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"stripe-integration/technical-reference/database-schema","title":"What Is the StripePayments Database Table?","description":"Complete reference for the StripePayments table columns, data types, and relationships with examples for troubleshooting.","source":"@site/versioned_docs/version-1.2/stripe-integration/technical-reference/database-schema.md","sourceDirName":"stripe-integration/technical-reference","slug":"/stripe-integration/technical-reference/database-schema","permalink":"/knowledgebase/stripe-integration/technical-reference/database-schema","draft":false,"unlisted":false,"tags":[],"version":"1.2","sidebarPosition":1,"frontMatter":{"title":"What Is the StripePayments Database Table?","sidebar_position":1,"description":"Complete reference for the StripePayments table columns, data types, and relationships with examples for troubleshooting.","keywords":["database","schema","stripepayments","table","columns","sql"]},"sidebar":"docsSidebar","previous":{"title":"Developer Access Guide","permalink":"/knowledgebase/stripe-integration/developer-access"},"next":{"title":"What Do the Payment Statuses Mean?","permalink":"/knowledgebase/stripe-integration/technical-reference/payment-status-lifecycle"}}');var r=n(4848),d=n(8453);const i={title:"What Is the StripePayments Database Table?",sidebar_position:1,description:"Complete reference for the StripePayments table columns, data types, and relationships with examples for troubleshooting.",keywords:["database","schema","stripepayments","table","columns","sql"]},c="What Is the StripePayments Database Table?",l={},o=[{value:"Column Reference",id:"column-reference",level:2},{value:"How Does AmountInCents Work?",id:"how-does-amountincents-work",level:2},{value:"How Does StripePayments Link to Customers?",id:"how-does-stripepayments-link-to-customers",level:2},{value:"What Do the Custom Routines Status Values Mean?",id:"what-do-the-custom-routines-status-values-mean",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function h(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",mermaid:"mermaid",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"what-is-the-stripepayments-database-table",children:"What Is the StripePayments Database Table?"})}),"\n",(0,r.jsx)(t.p,{children:"The StripePayments table is the main table that stores all payment information. Understanding each column is essential for troubleshooting."}),"\n",(0,r.jsx)(t.h2,{id:"column-reference",children:"Column Reference"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Column"}),(0,r.jsx)(t.th,{children:"Description"}),(0,r.jsx)(t.th,{children:"Example Value"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"PaymentId"})}),(0,r.jsx)(t.td,{children:"Unique internal ID (auto-generated)"}),(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"1"}),", ",(0,r.jsx)(t.code,{children:"2"}),", ",(0,r.jsx)(t.code,{children:"3"}),"..."]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"IdempotencyKey"})}),(0,r.jsx)(t.td,{children:"Prevents duplicate payments on retry"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"pay_abc123_1704795600000"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"CustomerUniqueId"})}),(0,r.jsx)(t.td,{children:"Links to the Customers table"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"CUST001"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"CustomerCode"})}),(0,r.jsx)(t.td,{children:"Customer's short code for reference"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"000001"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"StripeSessionId"})}),(0,r.jsx)(t.td,{children:"Stripe's checkout session ID"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"cs_test_a1b2c3..."})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"StripePaymentIntentId"})}),(0,r.jsx)(t.td,{children:"Stripe's payment intent ID"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"pi_3abc123..."})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"StripeSessionUrl"})}),(0,r.jsx)(t.td,{children:"The checkout URL the customer visited"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"https://checkout.stripe.com/..."})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"AmountInCents"})}),(0,r.jsx)(t.td,{children:"Payment amount in smallest currency unit"}),(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"2550"})," (= EUR 25.50)"]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"Currency"})}),(0,r.jsx)(t.td,{children:"3-letter currency code"}),(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"EUR"}),", ",(0,r.jsx)(t.code,{children:"USD"}),", ",(0,r.jsx)(t.code,{children:"GBP"})]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"ReferenceText"})}),(0,r.jsx)(t.td,{children:"User-entered reference (invoice number)"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"Invoice #2024-001"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"Status"})}),(0,r.jsx)(t.td,{children:"Current payment status"}),(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"created"}),", ",(0,r.jsx)(t.code,{children:"pending"}),", ",(0,r.jsx)(t.code,{children:"completed"})]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"CreatedAt"})}),(0,r.jsx)(t.td,{children:"When payment was initiated"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"2025-01-09 10:30:00"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"UpdatedAt"})}),(0,r.jsx)(t.td,{children:"Last status change time"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"2025-01-09 10:35:00"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"CompletedAt"})}),(0,r.jsx)(t.td,{children:"When payment succeeded (if applicable)"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"2025-01-09 10:35:00"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"ExpiresAt"})}),(0,r.jsx)(t.td,{children:"When the checkout session expires"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"2025-01-10 10:30:00"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"CreatedByEmail"})}),(0,r.jsx)(t.td,{children:"Email of user who initiated payment"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"john@abm.com"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"SourceRole"})}),(0,r.jsxs)(t.td,{children:["Who initiated: ",(0,r.jsx)(t.code,{children:"abm"})," or ",(0,r.jsx)(t.code,{children:"external"})]}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"abm"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"StripeEventId"})}),(0,r.jsx)(t.td,{children:"ID of Stripe webhook event that updated status"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"evt_abc123..."})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"StripeReceiptUrl"})}),(0,r.jsx)(t.td,{children:"Link to downloadable receipt"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"https://receipts.stripe.com/..."})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"FailureReason"})}),(0,r.jsx)(t.td,{children:"Error message if payment failed"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"Card was declined"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"LatestStatusUpdateSource"})}),(0,r.jsx)(t.td,{children:"What triggered the last update"}),(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"webhook"}),", ",(0,r.jsx)(t.code,{children:"polling"}),", ",(0,r.jsx)(t.code,{children:"public_polling"}),", ",(0,r.jsx)(t.code,{children:"cron"})]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"CustomRoutinesStatus"})}),(0,r.jsx)(t.td,{children:"Post-payment processing status"}),(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"skip"}),", ",(0,r.jsx)(t.code,{children:"pending"}),", ",(0,r.jsx)(t.code,{children:"completed"}),", ",(0,r.jsx)(t.code,{children:"error"})]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"CustomRoutinesProcessedAt"})}),(0,r.jsx)(t.td,{children:"When custom routines finished"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"2025-01-09 10:35:30"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"CustomRoutinesError"})}),(0,r.jsx)(t.td,{children:"Error message if failed"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"Procedure failed: ..."})})]})]})]}),"\n",(0,r.jsx)(t.h2,{id:"how-does-amountincents-work",children:"How Does AmountInCents Work?"}),"\n",(0,r.jsxs)(t.p,{children:["The amount is always stored in the ",(0,r.jsx)(t.strong,{children:"smallest currency unit"})," (cents/pence):"]}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Currency"}),(0,r.jsx)(t.th,{children:"Amount Shown"}),(0,r.jsx)(t.th,{children:"AmountInCents"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"EUR 25.50"}),(0,r.jsx)(t.td,{children:"Twenty-five euros fifty cents"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"2550"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"USD 100.00"}),(0,r.jsx)(t.td,{children:"One hundred dollars"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"10000"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"GBP 10.99"}),(0,r.jsx)(t.td,{children:"Ten pounds ninety-nine pence"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"1099"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"JPY 1000"}),(0,r.jsx)(t.td,{children:"One thousand yen"}),(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"1000"})," (no conversion*)"]})]})]})]}),"\n",(0,r.jsx)(t.p,{children:"*Japanese Yen and some other currencies have no decimal places."}),"\n",(0,r.jsx)(t.admonition,{type:"tip",children:(0,r.jsx)(t.p,{children:"To convert AmountInCents to the actual currency amount, divide by 100 (except for zero-decimal currencies like JPY)."})}),"\n",(0,r.jsx)(t.h2,{id:"how-does-stripepayments-link-to-customers",children:"How Does StripePayments Link to Customers?"}),"\n",(0,r.jsx)(t.mermaid,{value:'erDiagram\n    StripePayments ||--o| Customers : "links to"\n    StripePayments {\n        int PaymentId PK\n        string CustomerUniqueId FK\n        string CustomerCode\n        string Status\n        int AmountInCents\n        string Currency\n    }\n    Customers {\n        string UniqueId PK\n        string CustomerCode\n        string CustomerTitle\n        int CurrencyCode\n    }'}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"CustomerUniqueId"})," column links each payment to a customer record. The ",(0,r.jsx)(t.code,{children:"CustomerCode"})," is stored redundantly for quick reference without joining tables."]}),"\n",(0,r.jsx)(t.h2,{id:"what-do-the-custom-routines-status-values-mean",children:"What Do the Custom Routines Status Values Mean?"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Status"}),(0,r.jsx)(t.th,{children:"Meaning"}),(0,r.jsx)(t.th,{children:"Action Required"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"skip"})}),(0,r.jsx)(t.td,{children:"Feature disabled when payment completed"}),(0,r.jsx)(t.td,{children:"None"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"pending"})}),(0,r.jsx)(t.td,{children:"Waiting for processor"}),(0,r.jsx)(t.td,{children:"Wait"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"completed"})}),(0,r.jsx)(t.td,{children:"All procedures succeeded"}),(0,r.jsx)(t.td,{children:"None"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"error"})}),(0,r.jsx)(t.td,{children:"Procedure failed"}),(0,r.jsx)(t.td,{children:"Check CustomRoutinesError"})]})]})]}),"\n",(0,r.jsx)(t.admonition,{type:"warning",children:(0,r.jsxs)(t.p,{children:["Custom routines don't retry automatically. Error status means post-payment processing failed, but the payment itself is still ",(0,r.jsx)(t.code,{children:"completed"}),"."]})}),"\n",(0,r.jsx)(t.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.a,{href:"./payment-status-lifecycle",children:"What Do the Payment Statuses Mean?"})," - Status definitions and transitions"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.a,{href:"./payment-workflow",children:"How Does the Payment Workflow Work?"})," - Complete payment flow"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.a,{href:"./custom-routines",children:"Custom Routines Processing"})," - Post-payment automation"]}),"\n"]})]})}function a(e={}){const{wrapper:t}={...(0,d.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},8453(e,t,n){n.d(t,{R:()=>i,x:()=>c});var s=n(6540);const r={},d=s.createContext(r);function i(e){const t=s.useContext(d);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(d.Provider,{value:t},e.children)}}}]);