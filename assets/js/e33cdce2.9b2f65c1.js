"use strict";(globalThis.webpackChunkabm_web_portal_docs=globalThis.webpackChunkabm_web_portal_docs||[]).push([[1547],{7109(e,t,s){s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>d,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"stripe-integration/technical-reference/custom-routines","title":"How Do Custom Routines Work?","description":"Custom routines allow automatic execution of SQL stored procedures after payment completion for business automation.","source":"@site/versioned_docs/version-1.2/stripe-integration/technical-reference/custom-routines.md","sourceDirName":"stripe-integration/technical-reference","slug":"/stripe-integration/technical-reference/custom-routines","permalink":"/knowledgebase/stripe-integration/technical-reference/custom-routines","draft":false,"unlisted":false,"tags":[],"version":"1.2","sidebarPosition":4,"frontMatter":{"title":"How Do Custom Routines Work?","sidebar_position":4,"description":"Custom routines allow automatic execution of SQL stored procedures after payment completion for business automation.","keywords":["custom routines","stored procedures","automation","post-payment","sql"]},"sidebar":"docsSidebar","previous":{"title":"How Does the Payment Workflow Work?","permalink":"/knowledgebase/stripe-integration/technical-reference/payment-workflow"},"next":{"title":"Production Checklist","permalink":"/knowledgebase/stripe-integration/production-checklist"}}');var n=s(4848),r=s(8453);const i={title:"How Do Custom Routines Work?",sidebar_position:4,description:"Custom routines allow automatic execution of SQL stored procedures after payment completion for business automation.",keywords:["custom routines","stored procedures","automation","post-payment","sql"]},d="How Do Custom Routines Work?",c={},l=[{value:"How Does the Processing Flow Work?",id:"how-does-the-processing-flow-work",level:2},{value:"What Do the Custom Routines Statuses Mean?",id:"what-do-the-custom-routines-statuses-mean",level:2},{value:"What Should Support Teams Know?",id:"what-should-support-teams-know",level:2},{value:"How Do I Troubleshoot Custom Routines?",id:"how-do-i-troubleshoot-custom-routines",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function a(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"how-do-custom-routines-work",children:"How Do Custom Routines Work?"})}),"\n",(0,n.jsx)(t.p,{children:"Custom routines allow automatic execution of SQL stored procedures after a payment completes. This is useful for triggering business logic like updating invoice statuses, sending notifications, or syncing with external systems."}),"\n",(0,n.jsx)(t.h2,{id:"how-does-the-processing-flow-work",children:"How Does the Processing Flow Work?"}),"\n",(0,n.jsx)(t.mermaid,{value:"flowchart TD\n    A[Payment Completed] --\x3e B{Custom Routines<br/>Enabled?}\n    B --\x3e|No| C[Status: skip]\n    B --\x3e|Yes| D[Status: pending]\n    D --\x3e E[Processor runs<br/>every 60s]\n    E --\x3e F{Procedures<br/>succeed?}\n    F --\x3e|Yes| G[Status: completed]\n    F --\x3e|No| H[Status: error]"}),"\n",(0,n.jsx)(t.h2,{id:"what-do-the-custom-routines-statuses-mean",children:"What Do the Custom Routines Statuses Mean?"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Status"}),(0,n.jsx)(t.th,{children:"Meaning"}),(0,n.jsx)(t.th,{children:"Action Required"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"skip"})}),(0,n.jsx)(t.td,{children:"Feature disabled when payment completed"}),(0,n.jsx)(t.td,{children:"None"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"pending"})}),(0,n.jsx)(t.td,{children:"Waiting for processor"}),(0,n.jsx)(t.td,{children:"Wait"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"completed"})}),(0,n.jsx)(t.td,{children:"All procedures succeeded"}),(0,n.jsx)(t.td,{children:"None"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"error"})}),(0,n.jsx)(t.td,{children:"Procedure failed"}),(0,n.jsx)(t.td,{children:"Check CustomRoutinesError"})]})]})]}),"\n",(0,n.jsx)(t.h2,{id:"what-should-support-teams-know",children:"What Should Support Teams Know?"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"No automatic retry"}),": If a custom routine fails, it stays in ",(0,n.jsx)(t.code,{children:"error"})," status. Manual intervention is required."]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Payment still successful"}),": Custom routines failing does NOT affect the payment status. The payment is still ",(0,n.jsx)(t.code,{children:"completed"})," even if routines fail."]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Processing interval"}),": Configurable in Stripe App Configuration (",(0,n.jsx)(t.code,{children:"customRoutines.processIntervalMs"}),"); default is 60 seconds."]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Error messages"}),": Check ",(0,n.jsx)(t.code,{children:"CustomRoutinesError"})," for the specific error. Messages are truncated to 1000 characters."]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"how-do-i-troubleshoot-custom-routines",children:"How Do I Troubleshoot Custom Routines?"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Symptom"}),(0,n.jsx)(t.th,{children:"Likely Cause"}),(0,n.jsx)(t.th,{children:"Resolution"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsxs)(t.td,{children:["Status stuck on ",(0,n.jsx)(t.code,{children:"pending"})]}),(0,n.jsx)(t.td,{children:"Processor not running"}),(0,n.jsx)(t.td,{children:"Check server logs for processor errors"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsxs)(t.td,{children:["Status = ",(0,n.jsx)(t.code,{children:"error"})]}),(0,n.jsx)(t.td,{children:"Stored procedure failed"}),(0,n.jsx)(t.td,{children:"Check CustomRoutinesError, fix procedure"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsxs)(t.td,{children:["Status = ",(0,n.jsx)(t.code,{children:"skip"})]}),(0,n.jsx)(t.td,{children:"Feature disabled"}),(0,n.jsx)(t.td,{children:"Normal - no action needed"})]})]})]}),"\n",(0,n.jsx)(t.admonition,{type:"warning",children:(0,n.jsx)(t.p,{children:"Custom routines don't retry automatically. If a procedure fails, you must manually investigate and fix the issue. The payment itself remains complete and valid."})}),"\n",(0,n.jsx)(t.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"./database-schema",children:"What Is the StripePayments Database Table?"})," - Column reference including CustomRoutines fields"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"../setup/portal-configuration",children:"Portal Configuration"})," - How to enable and configure custom routines"]}),"\n"]})]})}function u(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(a,{...e})}):a(e)}},8453(e,t,s){s.d(t,{R:()=>i,x:()=>d});var o=s(6540);const n={},r=o.createContext(n);function i(e){const t=o.useContext(r);return o.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),o.createElement(r.Provider,{value:t},e.children)}}}]);